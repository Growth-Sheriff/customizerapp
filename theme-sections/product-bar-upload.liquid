{% comment %}
  Upload Lift - Product Showcase Bar with Custom Upload
  ======================================================
  Features:
  - Per-product Custom Upload toggle
  - Upload modal with sheet size & quantity
  - 3D T-Shirt viewer option
  - Local pickup alert
  - Floating cart button
  
  Version: 1.0.0
{% endcomment %}

{{ 'product-bar-upload.css' | asset_url | stylesheet_tag }}

{% comment %} Check if any product card has 3D viewer enabled {% endcomment %}
{%- assign has_3d_viewer = false -%}
{%- for block in section.blocks -%}
  {%- if block.type == 'product_card' and block.settings.show_3d_viewer -%}
    {%- assign has_3d_viewer = true -%}
    {%- break -%}
  {%- endif -%}
{%- endfor -%}

{% comment %} Load Three.js if 3D viewer is needed {% endcomment %}
{%- if has_3d_viewer -%}
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
{%- endif -%}

<section class="ul-product-bar" 
         id="ulProductBar-{{ section.id }}" 
         data-section-id="{{ section.id }}"
         data-api-base="{{ section.settings.upload_api_base | default: 'https://customizerapp.dev' }}"
         style="background: {{ section.settings.section_bg | default: '#ffffff' }}; padding: {{ section.settings.section_padding | default: '2rem 0' }};">
  
  <div class="ul-product-bar-container">
    
    <!-- Section Header -->
    {% if section.settings.show_header %}
    <div class="ul-product-bar-header">
      {% if section.settings.badge_text != blank %}
        <span class="ul-section-badge">{{ section.settings.badge_text }}</span>
      {% endif %}
      {% if section.settings.title != blank %}
        <h2 class="ul-section-title">{{ section.settings.title }}</h2>
      {% endif %}
      {% if section.settings.subtitle != blank %}
        <p class="ul-section-subtitle">{{ section.settings.subtitle }}</p>
      {% endif %}
    </div>
    {% endif %}
    
    <!-- Product Grid -->
    <div class="ul-product-bar-grid cols-{{ section.settings.mobile_columns | default: '2' }}">
      {% for block in section.blocks %}
        {% if block.type == 'product_card' %}
          {% assign card_product = block.settings.product %}
          {% assign enable_upload = block.settings.enable_custom_upload %}
          
          {% if card_product != blank %}
            <!-- Shopify Product Selected -->
            <div class="ul-product-bar-item" 
                 data-product-id="{{ card_product.id }}"
                 data-product-handle="{{ card_product.handle }}"
                 data-variant-id="{{ card_product.selected_or_first_available_variant.id }}"
                 data-enable-upload="{{ enable_upload }}"
                 data-product-title="{{ card_product.title | escape }}"
                 data-product-price="{{ card_product.price | money }}"
                 data-product-image="{% if card_product.featured_image %}{{ card_product.featured_image | image_url: width: 300 }}{% endif %}"
                 {{ block.shopify_attributes }}>
              
              <a href="{{ card_product.url }}" class="ul-product-bar-link">
                <div class="ul-product-bar-img">
                  {% if block.settings.show_3d_viewer %}
                    <!-- 3D T-Shirt Preview -->
                    <div class="ul-3d-tshirt-preview">
                      <canvas class="ul-mini-tshirt-canvas" data-block-id="{{ block.id }}"></canvas>
                      <div class="ul-3d-badge-label">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5"/></svg>
                        3D
                      </div>
                    </div>
                  {% elsif card_product.featured_image %}
                    <img src="{{ card_product.featured_image | image_url: width: 300 }}" 
                         alt="{{ card_product.title }}" 
                         width="300" 
                         height="300" 
                         loading="lazy"
                         class="ul-product-img">
                  {% else %}
                    <div class="ul-product-bar-placeholder">
                      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/>
                      </svg>
                    </div>
                  {% endif %}
                  
                  <!-- Badges -->
                  <div class="ul-product-badges">
                    {% if enable_upload %}
                    <span class="ul-badge ul-badge-upload">
                      <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                      Upload
                    </span>
                    {% endif %}
                    
                    {% if block.settings.show_4d_badge %}
                    <span class="ul-badge ul-badge-4d">
                      4D
                      <span class="ul-4d-discount">{{ block.settings.badge_discount_text | default: '20% OFF' }}</span>
                    </span>
                    {% endif %}
                    
                    {% if card_product.compare_at_price > card_product.price %}
                    {% assign discount_percent = card_product.compare_at_price | minus: card_product.price | times: 100.0 | divided_by: card_product.compare_at_price | round %}
                    <span class="ul-badge ul-badge-sale">-{{ discount_percent }}%</span>
                    {% endif %}
                  </div>
                  
                  <span class="ul-product-bar-btn">{{ section.settings.view_product_text | default: 'VIEW PRODUCT' }}</span>
                </div>
                
                <div class="ul-product-bar-content">
                  {% if card_product.vendor != blank %}
                  <span class="ul-product-vendor">{{ card_product.vendor }}</span>
                  {% endif %}
                  
                  <h3 class="ul-product-bar-title">{{ card_product.title }}</h3>
                  
                  <div class="ul-product-bar-rating">
                    {% assign rating = block.settings.rating | default: 5 %}
                    {% for i in (1..5) %}
                      {% if i <= rating %}
                        <svg class="ul-star ul-star-filled" width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                      {% else %}
                        <svg class="ul-star" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                      {% endif %}
                    {% endfor %}
                    <span class="ul-rating-count">({{ block.settings.review_count | default: 0 }})</span>
                  </div>
                  
                  <div class="ul-product-bar-prices">
                    {% if card_product.compare_at_price > card_product.price %}
                      <span class="ul-compare-price">{{ card_product.compare_at_price | money }}</span>
                    {% endif %}
                    <span class="ul-current-price">{{ card_product.price | money }}</span>
                  </div>
                </div>
              </a>
              
              <!-- Upload Area (if enabled) -->
              {% if enable_upload %}
              <div class="ul-product-upload-area">
                <button type="button" class="ul-upload-trigger-btn" data-product-id="{{ card_product.id }}">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                    <polyline points="17 8 12 3 7 8"/>
                    <line x1="12" y1="3" x2="12" y2="15"/>
                  </svg>
                  {{ block.settings.upload_text | default: section.settings.upload_text | default: 'Upload Design' }}
                </button>
              </div>
              {% endif %}
              
              <!-- Add to Cart Button -->
              <div class="ul-product-bar-actions">
                <button type="button" 
                        class="ul-add-to-cart-btn{% unless card_product.available %} ul-sold-out{% endunless %}" 
                        data-variant-id="{{ card_product.selected_or_first_available_variant.id }}"
                        {% unless card_product.available %}disabled{% endunless %}>
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                  </svg>
                  {% if card_product.available %}
                    {{ section.settings.add_to_cart_text | default: 'Add to Cart' }}
                  {% else %}
                    {{ section.settings.sold_out_text | default: 'Sold Out' }}
                  {% endif %}
                </button>
              </div>
            </div>
            
          {% else %}
            <!-- Manual Entry Fallback -->
            <div class="ul-product-bar-item ul-manual-product" {{ block.shopify_attributes }}>
              <a href="{{ block.settings.link | default: '#' }}" class="ul-product-bar-link">
                <div class="ul-product-bar-img">
                  {% if block.settings.image %}
                    <img src="{{ block.settings.image | image_url: width: 300 }}" 
                         alt="{{ block.settings.title }}" 
                         width="300" 
                         height="300" 
                         loading="lazy"
                         class="ul-product-img">
                  {% else %}
                    <div class="ul-product-bar-placeholder">
                      <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                        <rect x="3" y="3" width="18" height="18" rx="2"/><circle cx="8.5" cy="8.5" r="1.5"/><path d="M21 15l-5-5L5 21"/>
                      </svg>
                    </div>
                  {% endif %}
                  
                  {% if block.settings.show_4d_badge %}
                  <div class="ul-product-badges">
                    <span class="ul-badge ul-badge-4d">
                      4D
                      <span class="ul-4d-discount">{{ block.settings.badge_discount_text | default: '20% OFF' }}</span>
                    </span>
                  </div>
                  {% endif %}
                  
                  <span class="ul-product-bar-btn">{{ section.settings.view_product_text | default: 'VIEW PRODUCT' }}</span>
                </div>
                
                <div class="ul-product-bar-content">
                  <h3 class="ul-product-bar-title">{{ block.settings.title | default: 'Select a product' }}</h3>
                  
                  <div class="ul-product-bar-rating">
                    {% assign rating = block.settings.rating | default: 5 %}
                    {% for i in (1..5) %}
                      {% if i <= rating %}
                        <svg class="ul-star ul-star-filled" width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                      {% else %}
                        <svg class="ul-star" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/></svg>
                      {% endif %}
                    {% endfor %}
                    <span class="ul-rating-count">({{ block.settings.review_count | default: 0 }})</span>
                  </div>
                  
                  <div class="ul-product-bar-prices">
                    {% if block.settings.compare_price != blank %}
                      <span class="ul-compare-price">{{ block.settings.compare_price }}</span>
                    {% endif %}
                    <span class="ul-current-price">{{ block.settings.price | default: '$0.00' }}</span>
                  </div>
                </div>
              </a>
              
              <div class="ul-product-bar-actions">
                <a href="{{ block.settings.link | default: '#' }}" class="ul-add-to-cart-btn">
                  <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
                    <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
                  </svg>
                  {{ section.settings.add_to_cart_text | default: 'Add to Cart' }}
                </a>
              </div>
            </div>
          {% endif %}
        {% endif %}
      {% endfor %}
    </div>
    
    <!-- Local Pickup Alert -->
    {% if section.settings.show_pickup_alert %}
    <div class="ul-pickup-alert">
      <div class="ul-pickup-inner">
        <div class="ul-pickup-left">
          <span class="ul-pickup-dot"></span>
          <span class="ul-pickup-label">{{ section.settings.pickup_badge | default: 'Pickup available' }}</span>
        </div>
        <div class="ul-pickup-center">
          <span class="ul-pickup-location">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/>
            </svg>
            {{ section.settings.pickup_location | default: 'Dallas, TX' }}
          </span>
          <span class="ul-pickup-divider">•</span>
          <span class="ul-pickup-time">{{ section.settings.pickup_time | default: 'Today until 7:00 PM' }}</span>
        </div>
        <a href="{{ section.settings.pickup_link | default: '#' }}" class="ul-pickup-link">
          {{ section.settings.pickup_btn_text | default: 'View store info' }}
          <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
        </a>
      </div>
    </div>
    {% endif %}
    
  </div>
</section>

<!-- Floating Cart Button -->
{% if section.settings.show_floating_cart %}
<div class="ul-floating-cart" id="ulFloatingCart-{{ section.id }}">
  <a href="{{ routes.cart_url }}" class="ul-floating-cart-btn">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
      <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
    </svg>
    <span class="ul-floating-cart-text">{{ section.settings.floating_cart_text | default: 'View Cart' }}</span>
    <span class="ul-floating-cart-count">{{ cart.item_count }}</span>
  </a>
</div>
{% endif %}

<!-- Upload Modal -->
<div class="ul-upload-modal-overlay" id="ulUploadModal-{{ section.id }}">
  <div class="ul-upload-modal">
    <div class="ul-upload-modal-header">
      <h3 class="ul-upload-modal-title">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="17 8 12 3 7 8"/>
          <line x1="12" y1="3" x2="12" y2="15"/>
        </svg>
        Upload Your Design
      </h3>
      <button type="button" class="ul-upload-modal-close">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/>
        </svg>
      </button>
    </div>
    
    <div class="ul-upload-modal-body">
      <!-- Product Info -->
      <div class="ul-modal-product-info">
        <img src="" alt="" class="ul-modal-product-image">
        <div class="ul-modal-product-details">
          <h4 class="ul-modal-product-title">Product Name</h4>
          <span class="ul-modal-product-price">$0.00</span>
        </div>
      </div>
      
      <!-- Upload Zone -->
      <div class="ul-modal-upload-zone">
        <input type="file" class="ul-modal-file-input" accept=".png,.jpg,.jpeg,.webp,.pdf,.svg" hidden>
        <div class="ul-upload-zone-icon">
          <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17 8 12 3 7 8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
          </svg>
        </div>
        <p class="ul-upload-zone-text">Drag & drop your design here</p>
        <p class="ul-upload-zone-subtext">or click to browse</p>
        <span class="ul-upload-zone-formats">PNG, JPG, WebP, PDF, SVG • Max 50MB</span>
      </div>
      
      <!-- Upload Preview -->
      <div class="ul-modal-upload-preview" style="display: none;">
        <img src="" alt="Preview">
        <button type="button" class="ul-modal-remove-upload">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="3 6 5 6 21 6"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
          </svg>
          Remove
        </button>
        <div class="ul-modal-file-info">
          <span class="ul-file-name">filename.png</span>
          <span class="ul-file-size">2.5 MB</span>
        </div>
      </div>
      
      <!-- Options -->
      <div class="ul-modal-options">
        <!-- Sheet Size -->
        <div class="ul-modal-option-group">
          <label class="ul-modal-option-label">Select Sheet Size</label>
          <div class="ul-modal-size-grid">
            <button type="button" class="ul-modal-size-btn" data-size="22x6" data-price="7.50">
              <span class="ul-size-name">22" x 6"</span>
              <span class="ul-size-price">$7.50</span>
            </button>
            <button type="button" class="ul-modal-size-btn active" data-size="22x12" data-price="12.00">
              <span class="ul-size-name">22" x 12"</span>
              <span class="ul-size-price">$12.00</span>
            </button>
            <button type="button" class="ul-modal-size-btn" data-size="22x24" data-price="22.00">
              <span class="ul-size-name">22" x 24"</span>
              <span class="ul-size-price">$22.00</span>
            </button>
            <button type="button" class="ul-modal-size-btn" data-size="22x60" data-price="50.00">
              <span class="ul-size-name">22" x 60"</span>
              <span class="ul-size-price">$50.00</span>
            </button>
          </div>
        </div>
        
        <!-- Quantity -->
        <div class="ul-modal-option-group">
          <label class="ul-modal-option-label">Quantity</label>
          <div class="ul-modal-quantity">
            <button type="button" class="ul-modal-qty-btn ul-modal-qty-minus">−</button>
            <input type="number" class="ul-modal-qty-input" value="1" min="1" max="100">
            <button type="button" class="ul-modal-qty-btn ul-modal-qty-plus">+</button>
          </div>
        </div>
      </div>
      
      <!-- Total -->
      <div class="ul-modal-total">
        <span class="ul-modal-total-label">Total</span>
        <span class="ul-modal-total-price">$12.00</span>
      </div>
    </div>
    
    <div class="ul-upload-modal-footer">
      <button type="button" class="ul-modal-btn ul-modal-btn-secondary ul-modal-add-cart" disabled>
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <circle cx="9" cy="21" r="1"/><circle cx="20" cy="21" r="1"/>
          <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"/>
        </svg>
        Add to Cart
      </button>
      <button type="button" class="ul-modal-btn ul-modal-btn-primary ul-modal-checkout" disabled>
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/>
        </svg>
        Checkout
      </button>
    </div>
  </div>
</div>

{% schema %}
{
  "name": "UL Product Bar",
  "tag": "section",
  "class": "ul-homepage-product-bar",
  "settings": [
    {
      "type": "header",
      "content": "Section Layout"
    },
    {
      "type": "select",
      "id": "mobile_columns",
      "label": "Mobile Columns",
      "options": [
        { "value": "1", "label": "1 Column" },
        { "value": "2", "label": "2 Columns" }
      ],
      "default": "2"
    },
    {
      "type": "color",
      "id": "section_bg",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "text",
      "id": "section_padding",
      "label": "Padding",
      "default": "2rem 0"
    },
    {
      "type": "header",
      "content": "Section Header"
    },
    {
      "type": "checkbox",
      "id": "show_header",
      "label": "Show Header",
      "default": false
    },
    {
      "type": "text",
      "id": "badge_text",
      "label": "Badge Text",
      "placeholder": "e.g., BESTSELLERS"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Section Title",
      "placeholder": "e.g., Featured Products"
    },
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "placeholder": "e.g., Shop our most popular items"
    },
    {
      "type": "header",
      "content": "Card Settings"
    },
    {
      "type": "text",
      "id": "view_product_text",
      "label": "View Product Button Text",
      "default": "VIEW PRODUCT"
    },
    {
      "type": "header",
      "content": "Upload Feature"
    },
    {
      "type": "text",
      "id": "upload_api_base",
      "label": "Upload API Base URL",
      "default": "https://customizerapp.dev",
      "info": "API endpoint for file uploads"
    },
    {
      "type": "text",
      "id": "upload_text",
      "label": "Default Upload Button Text",
      "default": "Upload Design"
    },
    {
      "type": "header",
      "content": "Cart Buttons"
    },
    {
      "type": "text",
      "id": "add_to_cart_text",
      "label": "Add to Cart Text",
      "default": "Add to Cart"
    },
    {
      "type": "text",
      "id": "sold_out_text",
      "label": "Sold Out Text",
      "default": "Sold Out"
    },
    {
      "type": "header",
      "content": "Local Pickup Alert"
    },
    {
      "type": "checkbox",
      "id": "show_pickup_alert",
      "label": "Show Pickup Alert",
      "default": true
    },
    {
      "type": "text",
      "id": "pickup_badge",
      "label": "Badge Text",
      "default": "Pickup available"
    },
    {
      "type": "text",
      "id": "pickup_location",
      "label": "Location",
      "default": "Dallas, TX"
    },
    {
      "type": "text",
      "id": "pickup_time",
      "label": "Time",
      "default": "Today until 7:00 PM"
    },
    {
      "type": "text",
      "id": "pickup_btn_text",
      "label": "Button Text",
      "default": "View store info"
    },
    {
      "type": "url",
      "id": "pickup_link",
      "label": "Button Link"
    },
    {
      "type": "header",
      "content": "Floating Cart Button"
    },
    {
      "type": "checkbox",
      "id": "show_floating_cart",
      "label": "Show Floating Cart",
      "default": true
    },
    {
      "type": "text",
      "id": "floating_cart_text",
      "label": "Floating Cart Text",
      "default": "View Cart"
    }
  ],
  "blocks": [
    {
      "type": "product_card",
      "name": "Product Card",
      "settings": [
        {
          "type": "header",
          "content": "Product Selection"
        },
        {
          "type": "product",
          "id": "product",
          "label": "Select Product"
        },
        {
          "type": "header",
          "content": "Custom Upload"
        },
        {
          "type": "checkbox",
          "id": "enable_custom_upload",
          "label": "Enable Custom Upload",
          "info": "Show upload button for this product",
          "default": false
        },
        {
          "type": "text",
          "id": "upload_text",
          "label": "Upload Button Text",
          "placeholder": "Uses default if empty"
        },
        {
          "type": "header",
          "content": "3D Viewer"
        },
        {
          "type": "checkbox",
          "id": "show_3d_viewer",
          "label": "Show 3D T-Shirt Viewer",
          "info": "Replaces product image with animated 3D t-shirt",
          "default": false
        },
        {
          "type": "header",
          "content": "4D Discount Badge"
        },
        {
          "type": "checkbox",
          "id": "show_4d_badge",
          "label": "Show 4D Badge",
          "info": "Gold premium badge on top-right corner",
          "default": false
        },
        {
          "type": "text",
          "id": "badge_discount_text",
          "label": "Discount Text",
          "default": "20% OFF"
        },
        {
          "type": "header",
          "content": "Rating"
        },
        {
          "type": "range",
          "id": "rating",
          "label": "Rating Stars",
          "min": 0,
          "max": 5,
          "default": 5
        },
        {
          "type": "number",
          "id": "review_count",
          "label": "Review Count",
          "default": 55
        },
        {
          "type": "header",
          "content": "Manual Override (Optional)"
        },
        {
          "type": "paragraph",
          "content": "Use these fields only if no product is selected above."
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Product Image"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Product Title",
          "default": "Premium DTF Transfer"
        },
        {
          "type": "text",
          "id": "price",
          "label": "Price",
          "default": "$29.99"
        },
        {
          "type": "text",
          "id": "compare_price",
          "label": "Compare at Price",
          "placeholder": "$39.99"
        },
        {
          "type": "url",
          "id": "link",
          "label": "Product Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "UL Product Bar",
      "category": "Products",
      "settings": {
        "show_pickup_alert": true,
        "show_floating_cart": true
      },
      "blocks": [
        { "type": "product_card" },
        { "type": "product_card" },
        { "type": "product_card" },
        { "type": "product_card" },
        { "type": "product_card" }
      ]
    }
  ]
}
{% endschema %}

{{ 'product-bar-upload.js' | asset_url | script_tag }}
